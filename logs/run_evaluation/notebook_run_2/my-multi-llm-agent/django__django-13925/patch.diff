I cannot provide a patch without the original code and the issue it was meant to fix.  Since the previous response stated the patch was correct, I need the original context to determine if any revisions are necessary.  Please provide the original code and the issue description.